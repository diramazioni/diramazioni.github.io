{% macro render_menu() %}

<nav id="menu" class="uk-navbar-container uk-navbar-transparent" uk-navbar uk-sticky="top: 60; cls-inactive: uk-position-fixed">
  <!-- page navigation -->


    <div id="page_nav" class="uk-navbar-left">
      <a id="smenu" href="#" {% if this.body %}uk-toggle="target: #offcanvas-nav"{% endif %}>

        <svg id="svg4219" xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#" xmlns="http://www.w3.org/2000/svg" height="80" width="80" version="1.1" xmlns:cc="http://creativecommons.org/ns#" xmlns:dc="http://purl.org/dc/elements/1.1/" viewBox="0 0 80.000001 79.999998">
         <defs id="defs4221">
          <filter id="filter6104" style="color-interpolation-filters:sRGB" height="1.024" width="1.024" y="-.012" x="-.012">
           <feGaussianBlur id="feGaussianBlur6106" stdDeviation="0.29276609"/>
          </filter>
         </defs>
         <g id="layer1" transform="translate(-35 -912.36)">
          <g id="g5806" stroke-opacity="0" transform="matrix(1.3343 0 0 1.3343 -25.069 -318.33)">
           <circle id="let_BG" filter="url(#filter6104)" cy="952.36" cx="75" r="29.277" fill="#510d0e"/>
           <g id="g5143" transform="matrix(.34448 0 0 .34448 49.053 624.29)">
            <g fill-rule="evenodd">
             <rect id="rect6" transform="rotate(-90)" height="13.132" width="13.132" y="53.369" x="-996.43" fill="#668000"/>
             <g id="let_E" transform="translate(-3.841 -1.7038)" fill="#ff8c00">
              <rect id="rect9" transform="scale(-1,1)" height="13.132" width="13.132" y="970" x="-115.47"/>
              <rect id="rect11" transform="scale(-1,1)" height="13.132" width="13.132" y="985" x="-115.47"/>
              <rect id="rect13" transform="matrix(0,-1,-1,0,0,0)" height="13.132" width="13.132" y="-100.47" x="-998.13"/>
              <rect id="rect15" transform="scale(-1,1)" height="13.132" width="13.132" y="955" x="-115.47"/>
              <rect id="rect17" transform="matrix(0,-1,-1,0,0,0)" height="13.132" width="13.132" y="-85.474" x="-998.13"/>
              <rect id="rect19" height="13.132" width="13.132" y="970" x="42.212"/>
              <rect id="rect21" height="13.132" width="13.132" y="985" x="42.212"/>
              <rect id="rect23" transform="rotate(-90)" height="13.132" width="13.132" y="57.21" x="-998.13"/>
              <rect id="rect25" height="13.132" width="13.132" y="955" x="42.212"/>
              <rect id="rect27" transform="matrix(0,-1,-1,0,0,0)" height="13.132" width="13.132" y="-85.474" x="-983.13"/>
             </g>
             <g id="let_I" transform="translate(-3.841 -1.7038)" fill="#8a0">
              <rect id="rect30" transform="rotate(-90)" height="13.132" width="13.132" y="72.212" x="-953.13"/>
              <rect id="rect32" y="955" x="72.212" height="13.132" width="13.132"/>
              <rect id="rect34" transform="scale(-1)" height="13.132" width="13.132" y="-983.13" x="-85.344"/>
              <rect id="rect36" y="925" x="72.212" height="13.132" width="13.132"/>
              <rect id="rect38" transform="rotate(90)" height="13.132" width="13.132" y="-85.344" x="910"/>
             </g>
             <g id="let_L" transform="translate(-3.841 -1.7038)" fill="#668000">
              <rect id="rect41" transform="rotate(-90)" height="13.132" width="13.132" y="42.212" x="-968.13"/>
              <rect id="rect43" y="970" x="42.212" height="13.132" width="13.132"/>
              <rect id="rect45" transform="rotate(-90)" height="13.132" width="13.132" y="42.212" x="-998.13"/>
              <rect id="rect47" transform="rotate(90)" height="13.132" width="13.132" y="-55.344" x="940"/>
              <rect id="rect49" transform="scale(-1)" height="13.132" width="13.132" y="-938.13" x="-55.344"/>
              <rect id="rect51" y="985" x="57.212" height="13.132" width="13.132"/>
             </g>
            </g>
            <circle id="let_DOT" cx="105.06" cy="929.83" r="6.7764" fill="#cf1b00"/>
           </g>
          </g>
         </g>
        </svg>
      </a>
    </div>

    <!-- @@@ small screens -->
    <!--   -->
    <div id="menu_bar-s" class="uk-navbar-right uk-hidden@m ">

      <div class="navbar_toggle">
        <a id="navbar_toggle" href="#" class="uk-navbar-toggle" uk-icon="icon: menu"></a>
        <!-- <a id="navbar_toggle" href="#" class="uk-navbar-toggle" uk-icon="icon: menu" uk-toggle="target: .accordion_menu; animation: uk-animation-fade"></a> -->
      </div>
    </div>
    <!-- END small screen menu -->

    <!-- @@@ medium screens -->
    <div id="menu_bar-m" class="uk-navbar-right uk-visible@m">

      <ul class="uk-navbar-nav" >
        {% for id, item in bag('menu').items() %}
        <li{% if (this.is_child_of(item.path) and item.path != '/') %} class="menu-active uk-border-rounded" {% endif%}>
          <a href="{{ item.path|url }}">{{ item.label }}</a>
        </li>
        {% endfor %} 
          <!-- recursive menu -->
          {% set root = site.get('/projects') %}
          {% for child in root.children recursive %} {% set child_len = loop(child.children)|length %}
          <li class="{% if this._path == child._path %}menu-active {% endif %}{% if child_len > 0 and loop.depth >1 %}uk-parent {% endif %}">
            <a href="{{ child|url }}">{{ child.title }}</a>
            {% if child_len > 0 and loop.depth == 1 %} {#{% if this.is_child_of(child) %}#}
            <div class="uk-navbar-dropdown">
              <ul class="uk-nav uk-navbar-dropdown-nav">{{ loop(child.children) }}</ul>
            </div>
            {% elif child_len > 0 and loop.depth > 1 %}
            <ul class="uk-nav-sub">{{ loop(child.children) }}</ul>
            {% endif %}
          </li>
          {% endfor %}
      </ul>
    </div>

  <!-- END medium screen -->

</nav>
<div class="accordion_menu uk-hidden@m" style="display: none">
  <ul class="uk-nav-parent-icon" uk-nav>
    {% for id, item in bag('menu').items() %}
      <li {%- if this.is_child_of(item.path) and item.path != '/' %} class="menu-active" {% endif%}>
        <a href="{{ item.path|url }}">{{ item.label }}</a>
      </li>
    {% endfor %}
      <!-- accordion recursive menu -->
      {% set root = site.get('/projects') %} 
      {% for child in root.children recursive %} 
        {% set child_len = loop(child.children)|length %}
        <li class="{% if this._path == child._path %}menu-active {% endif %}{% if child_len > 0 and loop.depth == 1 %}uk-parent {% endif %}">
          <a href="{{ child|url }}">{{ child.title }}</a> 
          {% if child_len > 0 %}
          <ul class="uk-nav-sub">{{ loop(child.children) }}</ul>
          {% endif %}   
        </li>
      {% endfor %}
  </ul>
</div>

{% if this.body %}

<div id="offcanvas-nav" uk-offcanvas="flip: true;">
  <div class="uk-offcanvas-bar">

    <ul class="uk-nav uk-nav-default uk-list" uk-scrollspy-nav="closest: li; scroll: true; offset:150; cls: toc-active">
      <li><a href="#" uk-totop uk-scroll>top</a></li>
      {% for item in this.body.toc recursive %}
      <li><a href="#{{ item.anchor }}">{{ item.title }}</a> {%if item.children %}
        <ul class="toc uk-list uk-list-divider">{{ loop(item.children) }}</ul>
        {% endif %}
      </li>
      {% endfor %}
    </ul>
  </div>
</div>
{% endif %}


{% endmacro %}
